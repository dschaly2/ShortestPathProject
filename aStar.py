import heapq
import numpy as np

class Node:
    def __init__(self, index, parent=None, g_cost=float('inf'), h_cost=0):
        self.index = index
        self.parent = parent
        self.g_cost = g_cost
        self.h_cost = h_cost

    def f_cost(self):
        return self.g_cost + self.h_cost

    def __lt__(self, other):
        if self.f_cost() == other.f_cost():
            return self.g_cost > other.g_cost
        return self.f_cost() < other.f_cost()

def astar(adj_matrix, start, end):
    num_nodes = len(adj_matrix)
    open_set = []
    closed_set = set()
    visited_nodes = {}

    start_node = Node(start, None, 0, adj_matrix[start][end])
    heapq.heappush(open_set, start_node)

    while open_set:
        current_node = heapq.heappop(open_set)

        if current_node.index == end:
            path = reconstruct_path(current_node, visited_nodes)
            return current_node.g_cost, path

        if current_node.index in closed_set:
            continue

        closed_set.add(current_node.index)
        visited_nodes[current_node.index] = current_node

        for neighbor in range(num_nodes):
            if adj_matrix[current_node.index][neighbor] > 0:
                g_cost = current_node.g_cost + adj_matrix[current_node.index][neighbor]
                h_cost = adj_matrix[neighbor][end]  # Updated heuristic to actual edge cost
                neighbor_node = Node(neighbor, current_node, g_cost, h_cost)

                if neighbor_node.index not in closed_set:
                    heapq.heappush(open_set, neighbor_node)

    return float('inf'), []

def reconstruct_path(node, visited_nodes):
    path = []
    while node is not None:
        path.insert(0, node.index)
        node = node.parent
    return path

largest_adjacency_matrix = np.array([
    [0.0, 2.0, 3.0, 13.0, 14.0, 11.0, 4.0, 7.0, 15.0, 6.0, 1.0, 10.0, 3.0, 13.0, 6.0, 12.0, 10.0, 4.0, 2.0, 13.0, 15.0, 3.0, 8.0, 12.0, 13.0],
    [2.0, 0.0, 14.0, 3.0, 10.0, 9.0, 13.0, 1.0, 3.0, 2.0, 6.0, 10.0, 14.0, 9.0, 11.0, 1.0, 4.0, 6.0, 9.0, 4.0, 8.0, 10.0, 4.0, 12.0, 12.0],
    [3.0, 14.0, 0.0, 8.0, 14.0, 9.0, 4.0, 2.0, 15.0, 2.0, 2.0, 15.0, 5.0, 8.0, 13.0, 15.0, 9.0, 14.0, 7.0, 1.0, 5.0, 15.0, 13.0, 6.0, 15.0],
    [13.0, 3.0, 8.0, 0.0, 7.0, 7.0, 15.0, 11.0, 13.0, 11.0, 10.0, 5.0, 1.0, 9.0, 12.0, 15.0, 1.0, 5.0, 4.0, 13.0, 7.0, 10.0, 2.0, 3.0, 5.0],
    [14.0, 10.0, 14.0, 7.0, 0.0, 5.0, 8.0, 14.0, 9.0, 7.0, 4.0, 5.0, 6.0, 10.0, 1.0, 14.0, 6.0, 13.0, 10.0, 13.0, 12.0, 9.0, 3.0, 1.0, 1.0],
    [11.0, 9.0, 9.0, 7.0, 5.0, 0.0, 10.0, 9.0, 15.0, 13.0, 8.0, 1.0, 3.0, 12.0, 12.0, 6.0, 11.0, 2.0, 3.0, 10.0, 2.0, 8.0, 8.0, 9.0, 14.0],
    [4.0, 13.0, 4.0, 15.0, 8.0, 10.0, 0.0, 2.0, 11.0, 6.0, 9.0, 14.0, 10.0, 9.0, 15.0, 8.0, 6.0, 3.0, 14.0, 2.0, 14.0, 1.0, 2.0, 14.0, 1.0],
    [7.0, 1.0, 2.0, 11.0, 14.0, 9.0, 2.0, 0.0, 14.0, 15.0, 5.0, 7.0, 4.0, 11.0, 14.0, 4.0, 9.0, 4.0, 4.0, 8.0, 3.0, 9.0, 1.0, 8.0, 12.0],
    [15.0, 3.0, 15.0, 13.0, 9.0, 15.0, 11.0, 14.0, 0.0, 13.0, 1.0, 12.0, 7.0, 3.0, 14.0, 12.0, 1.0, 5.0, 10.0, 15.0, 3.0, 8.0, 8.0, 10.0, 12.0],
    [6.0, 2.0, 2.0, 11.0, 7.0, 13.0, 6.0, 15.0, 13.0, 0.0, 9.0, 4.0, 6.0, 4.0, 1.0, 8.0, 8.0, 12.0, 8.0, 15.0, 12.0, 6.0, 14.0, 11.0, 2.0],
    [1.0, 6.0, 2.0, 10.0, 4.0, 8.0, 9.0, 5.0, 1.0, 9.0, 0.0, 10.0, 11.0, 3.0, 1.0, 8.0, 6.0, 13.0, 13.0, 8.0, 6.0, 11.0, 7.0, 4.0, 4.0],
    [10.0, 10.0, 15.0, 5.0, 5.0, 1.0, 14.0, 7.0, 12.0, 4.0, 10.0, 0.0, 1.0, 9.0, 11.0, 11.0, 15.0, 4.0, 14.0, 4.0, 3.0, 9.0, 14.0, 14.0, 13.0],
    [3.0, 14.0, 5.0, 1.0, 6.0, 3.0, 10.0, 4.0, 7.0, 6.0, 11.0, 1.0, 0.0, 1.0, 2.0, 7.0, 12.0, 12.0, 12.0, 14.0, 12.0, 12.0, 2.0, 7.0, 3.0],
    [13.0, 9.0, 8.0, 9.0, 10.0, 12.0, 9.0, 11.0, 3.0, 4.0, 3.0, 9.0, 1.0, 0.0, 10.0, 3.0, 12.0, 5.0, 3.0, 3.0, 1.0, 1.0, 13.0, 14.0, 9.0],
    [6.0, 11.0, 13.0, 12.0, 1.0, 12.0, 15.0, 14.0, 14.0, 1.0, 1.0, 11.0, 2.0, 10.0, 0.0, 14.0, 9.0, 2.0, 12.0, 7.0, 13.0, 5.0, 15.0, 5.0, 11.0],
    [12.0, 1.0, 15.0, 15.0, 14.0, 6.0, 8.0, 4.0, 12.0, 8.0, 8.0, 11.0, 7.0, 3.0, 14.0, 0.0, 15.0, 12.0, 2.0, 10.0, 13.0, 15.0, 7.0, 5.0, 9.0],
    [10.0, 4.0, 9.0, 1.0, 6.0, 11.0, 6.0, 9.0, 1.0, 8.0, 6.0, 15.0, 12.0, 12.0, 9.0, 15.0, 0.0, 2.0, 14.0, 3.0, 2.0, 3.0, 12.0, 15.0, 4.0],
    [4.0, 6.0, 14.0, 5.0, 13.0, 2.0, 3.0, 4.0, 5.0, 12.0, 13.0, 4.0, 12.0, 5.0, 2.0, 12.0, 2.0, 0.0, 5.0, 10.0, 6.0, 15.0, 9.0, 5.0, 2.0],
    [2.0, 9.0, 7.0, 4.0, 10.0, 3.0, 14.0, 4.0, 10.0, 8.0, 13.0, 14.0, 12.0, 3.0, 12.0, 2.0, 14.0, 5.0, 0.0, 10.0, 1.0, 1.0, 10.0, 10.0, 2.0],
    [13.0, 4.0, 1.0, 13.0, 13.0, 10.0, 2.0, 8.0, 15.0, 15.0, 8.0, 4.0, 14.0, 3.0, 7.0, 10.0, 3.0, 10.0, 10.0, 0.0, 12.0, 1.0, 10.0, 1.0, 7.0],
    [15.0, 8.0, 5.0, 7.0, 12.0, 2.0, 14.0, 3.0, 3.0, 12.0, 6.0, 3.0, 12.0, 1.0, 13.0, 13.0, 2.0, 6.0, 1.0, 12.0, 0.0, 2.0, 15.0, 14.0, 5.0],
    [3.0, 10.0, 15.0, 10.0, 9.0, 8.0, 1.0, 9.0, 8.0, 6.0, 11.0, 9.0, 12.0, 1.0, 5.0, 15.0, 3.0, 15.0, 1.0, 1.0, 2.0, 0.0, 10.0, 8.0, 1.0],
    [8.0, 4.0, 13.0, 2.0, 3.0, 8.0, 2.0, 1.0, 8.0, 14.0, 7.0, 14.0, 2.0, 13.0, 15.0, 7.0, 12.0, 9.0, 10.0, 10.0, 15.0, 10.0, 0.0, 10.0, 6.0],
    [12.0, 12.0, 6.0, 3.0, 1.0, 9.0, 14.0, 8.0, 10.0, 11.0, 4.0, 14.0, 7.0, 14.0, 5.0, 5.0, 15.0, 5.0, 10.0, 1.0, 14.0, 8.0, 10.0, 0.0, 8.0],
    [13.0, 12.0, 15.0, 5.0, 1.0, 14.0, 1.0, 12.0, 12.0, 2.0, 4.0, 13.0, 3.0, 9.0, 11.0, 9.0, 4.0, 2.0, 2.0, 7.0, 5.0, 1.0, 6.0, 8.0, 0.0]
])

smallest_adjacency_matrix = np.array([
    [0.0, 14.0, 3.0, 3.0, 12.0], [14.0, 0.0, 12.0, 2.0, 9.0], 
    [3.0, 12.0, 0.0, 11.0, 14.0], [3.0, 2.0, 11.0, 0.0, 4.0], 
    [12.0, 9.0, 14.0, 4.0, 0.0]
])

blocked_adjacency_matrix = np.array([
    [0.0, 5.0, 5.0, 13.0, 6.0, -1.0, 6.0, 14.0, 8.0, 2.0, 5.0, 5.0, 2.0, -1.0, 3.0], [5.0, 0.0, 7.0, 15.0, 3.0, 8.0, 3.0, 14.0, 3.0, -1.0, 6.0, 5.0, 8.0, 6.0, 1.0], 
    [5.0, 7.0, 0.0, 4.0, 12.0, 15.0, 5.0, 15.0, 9.0, 15.0, 2.0, 4.0, -1.0, 3.0, 12.0], [13.0, 15.0, 4.0, 0.0, 5.0, 1.0, 11.0, 4.0, 3.0, -1.0, 3.0, 5.0, 11.0, 8.0, 13.0], 
    [6.0, 3.0, 12.0, -1.0, 0.0, 10.0, 13.0, 8.0, 9.0, 7.0, 1.0, 13.0, 5.0, 12.0, 7.0], [15.0, 8.0, 15.0, 1.0, 10.0, 0.0, 11.0, 1.0, 5.0, -1.0, 6.0, 1.0, 2.0, 6.0, 15.0], 
    [6.0, 3.0, 5.0, 11.0, -1.0, 11.0, 0.0, 7.0, 13.0, 7.0, 2.0, 1.0, 13.0, 14.0, 3.0], [14.0, 14.0, 15.0, 4.0, 8.0, 1.0, 7.0, 0.0, 14.0, -1.0, 1.0, 15.0, 5.0, 14.0, 13.0], 
    [8.0, 3.0, 9.0, 3.0, 9.0, 5.0, 13.0, 14.0, 0.0, 13.0, 10.0, 11.0, 3.0, 13.0, 12.0], [2.0, 8.0, 15.0, 6.0, 7.0, 2.0, 7.0, 6.0, 13.0, -1.0, 5.0, 1.0, 7.0, 3.0, 6.0], 
    [5.0, 6.0, 2.0, 3.0, 1.0, 6.0, -1.0, 1.0, 10.0, 5.0, 0.0, -1.0, 5.0, 14.0, 5.0], [5.0, 5.0, 4.0, 5.0, 13.0, 1.0, 1.0, 15.0, 11.0, 1.0, 13.0, 0.0, 6.0, -1.0, 13.0], 
    [2.0, 8.0, 5.0, 11.0, 5.0, 2.0, 13.0, 5.0, -1.0, 7.0, 5.0, 6.0, 0.0, 7.0, 7.0], [14.0, 6.0, 3.0, 8.0, 12.0, 6.0, 14.0, 14.0, 13.0, 3.0, 14.0, 12.0, 7.0, 0.0, 5.0], 
    [3.0, 1.0, 12.0, 13.0, 7.0, 15.0, -1.0, 13.0, 12.0, 6.0, 5.0, 13.0, 7.0, 5.0, 0.0]
])


start_node = 0
end_node = 4

shortest_distance, nodes_traveled = astar(largest_adjacency_matrix, start_node, end_node)

if shortest_distance < float('inf'):
    print(f"Shortest distance from {start_node} to {end_node}: {shortest_distance}")
    print(f"Nodes traveled: {nodes_traveled}")
else:
    print(f"No path from {start_node} to {end_node}")

shortest_distance, nodes_traveled = astar(smallest_adjacency_matrix, start_node, end_node)

if shortest_distance < float('inf'):
    print(f"Shortest distance from {start_node} to {end_node}: {shortest_distance}")
    print(f"Nodes traveled: {nodes_traveled}")
else:
    print(f"No path from {start_node} to {end_node}")


shortest_distance, nodes_traveled = astar(blocked_adjacency_matrix, start_node, end_node)

if shortest_distance < float('inf'):
    print(f"Shortest distance from {start_node} to {end_node}: {shortest_distance}")
    print(f"Nodes traveled: {nodes_traveled}")
else:
    print(f"No path from {start_node} to {end_node}")
